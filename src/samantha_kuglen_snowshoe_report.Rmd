---
title: "Assignment 4 - Task 2"
author: "Samantha Kuglen"
date: "11/5/2021"
output: html_document
---
## 3A) Overview

**Data Citation: **

## 3B) Data and Analysis

## Setup
```{r setup, include=FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

# Attach packages
library(tidyverse)
library(here)
library(janitor)
library(lubridate)
library(ggplot2)
library(effsize)
```

## Read in the Data
```{r}
# Store Bonanza Hares csv as new object `hare_data`, update date to YYYY-MM-DD format, and create new column `year`
juvenile_hare_data <- read_csv(here("data", "bonanza_hares.csv")) %>% 
  filter(age =="j") %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date)) %>% 
  mutate(site_names = case_when(
    grid %in% c("bonrip") ~ "Bonanza Riparian",
    grid %in% c("bonmat") ~ "Bonanza Mature",
    grid %in% c("bonbs") ~ "Bonanza Black Spruce" 
  )) %>% 
  mutate(sex = case_when(
    sex %in% c("m") ~ "Male",
    sex %in% c("f") ~ "Female",
    sex %in% c("NA") ~ "NA"
  ))
```

## 3C - I: Juvenile Hare Initial Investigation
```{r}
# Count the total # of juvenile hare trappings during each year of the study

juvenile_hare_counts <- juvenile_hare_data %>% 
  group_by(year) %>% 
  summarize(sample_size = n()) 

juvenile_hare_stats <- juvenile_hare_counts %>% 
  summarize(mean = mean(sample_size),
            median = median(sample_size),
            sd = sd(sample_size),
            max = max(sample_size),
            min = min(sample_size)) 
  
```

## 3C - I: Juvenile Hare Data Visualization
```{r, fig.cap='cap'}
# Finalized data visualization of the juvenile hare counts by year
ggplot(juvenile_hare_counts, aes(x = year, y = sample_size)) +
  geom_col(color = "#037bfc", 
           fill = "#037bfc",
           alpha = 0.75) +
  scale_x_continuous(breaks = 1999:2012) + 
  scale_y_continuous(breaks = seq(min(0), max(130), by = 20)) +
  labs(x = "Year",
       y = "Number of Hares",
       title = "Annual Juvenile Hare Trap Counts (KUGLEN)") +
  theme_minimal() +
  theme(plot.title = element_text(hjust = 0.5),
        legend.position = "none")

```
Major takeaways from the graph about total snowshoe hare trappings: 
- The minimum and maximum counts of juvenile hare trappings
- Mean and median annual number of juvenile hares trapped
- Notable trends include
- Moving forward, to standardize the juvenile hare population in future analyses

## 3C - II: Visualize Juvenile Hare Weights
```{r, fig.cap='cap'}
# Finalized data visualizations comparing juvenile hare weights by sex and site (grid) and omitting other variables and including groups where variables are not recorded (`NA`)
```

Main takeaways from the graph: 

## 3C - III: Juvenile Weight Comparison (Male & Female Snowshoe Hares)
Further comparison of mean weights for **juvenile male and female snowshoe hares**
```{r}
# Finalized table containing the mean, standard deviation, and sample size for male and female juvenile snowshoe hares, with a table caption

ggplot(juvenile_hare_data) + 
  geom_histogram(alpha = 0.7, aes(x = weight, fill = sex, color = sex)) + 
  facet_wrap(~site_names) +
  scale_fill_manual(values = c("#eba834", "#34b7eb", "grey")) +
  scale_color_manual(values = c("#eba834", "#34b7eb", "grey")) 
  labs(x = "Weight (g)",
       y = "Count",
       title = "Juvenile Snowshoe Hare Weight Comparison (KUGLEN)") +
  theme(plot.title = element_text(hjust = 0.5))
  
  juvenile_weight_stats <- juvenile_hare_data %>% 
    group_by(sex) %>% 
    select(sex, weight) %>% 
    summarize(mean = mean(weight, na.rm = TRUE),
              sd = sd(weight, na.rm = TRUE),
              median = median(weight, na.rm = TRUE))

```
Comparison of the means: 
- The actual difference in means
- Effect size (Cohen's *d*)
- Outcome of an unpaired two-sample t-test

## 3C - IV: Relationship Between Juvenile Weight & Hind Foot Length
Exploration of the relationship between juvenile snowshoe hare hind foot length (mm) and weight of all juvenile hares in the study.
```{r}
# Final visualization of juvenile hare hind foot length versus weight.
ggplot(juvenile_hare_data, aes(x = hindft, y = weight)) + 
  geom_point() + 
  labs(x = "Hind Foot Length (mm)",
       y = "Weight",
       title = "Juvenile Weight Comparison")

```

```{r}
hare_lm <- lm(weight ~ hindft, data = juvenile_hare_data)
plot(hare_lm)

male_hares <- juvenile_hare_data %>% 
  filter(sex == "Male", age == "j") %>% 
  filter(!is.na(weight)) %>% 
  pull(weight)

female_hares <- juvenile_hare_data %>% 
  filter(sex == "Female", age == "j") %>% 
  filter(!is.na(weight)) %>% 
  pull(weight)

cohen_hares <- cohen.d(female_hares, male_hares)

t.test(male_hares, female_hares)
 
#female_mean <- mean(female_hares)
#male_mean <- mean(male_hares) 

#actual_mean_difference <- (male_mean - female_mean)

```


